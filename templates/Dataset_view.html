{% extends "layout.html" %}
{% block content %}
<div class="jumbotron">
    <div class="row">
        <h2> *Dataset* </h2>
    </div>
    <br/>
    <div class="row">
        {% for key, list in value.items() %}
        <div class="col-md-4">
            <strong>{{ key }}:</strong>
            <select id={{ key }} onchange="choice(this, event)">
                <option value="none" >none</option>
                {% for e in list %}
                <option value={{ e }}>{{ e }}</option>
                {% endfor %}
            </select>
        </div>
        {% endfor%}
    </div>
    <br/>
    <br/>
    <div class="row" id="dataset_view">
    </div>
<script type="text/javascript">
///////////////////////////////////////////////////////////////////
/// ***GLOBALS*** ///
///////////////////////////////////////////////////////////////////
var $SCRIPT_ROOT = {{ request.script_root|tojson|safe }};
///////////////////////////////////////////////////////////////////
/// ***Functions($)*** ///
///////////////////////////////////////////////////////////////////
function choice(id, event){
    event.preventDefault()
    var tag = {
            "key": "dataset_view", 
            "selection": id.options[id.selectedIndex].text, 
            "id": id.id
            };
    $.ajax({
        type: "GET",
        url: $SCRIPT_ROOT + "/postman",
        data: tag,
        success: refresh_div,
    });
};
///////////////////////////////////////////////////////////////////
function delete_file(id, event){
    event.preventDefault()
    console.log(id, event)
    var tagd = {
            "key": "delete_file",
            "path": id.dataset.path
            };
    $.ajax({
        type: "GET",
        url: $SCRIPT_ROOT + "/postman",
        data: tagd,
        success: refresh_div,
    });
};
///////////////////////////////////////////////////////////////////
function refresh_div(data){
    $('#dataset_view').replaceWith(data.data);
};
//////////////////////////////////////////////////////////////////
/// ***BUTTONS*** ///
//////////////////////////////////////////////////////////////////

///////////////////////////////////////////////////////////////////
</script>
</div>
{% endblock content %}
